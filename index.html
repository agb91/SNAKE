<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
    <head>
        <title>Classe JavaScript per generare una tabella html - Dev-OClock.com</title>
    </head>
    <body onload = "setInterval('avanza()',500);">
        
        <!-- div container -->
        <div id="div-table"></div>
        
        <script type="text/javascript">
            
            //*** class definition ***
            //variabili
            //IL SERPENTE Ãˆ RAPRESENTATO DA UNA TESTA (COO X E Y) E 2 ARRAY DI PUNTI (CON COO X E Y)
            var contRow = 0;
            var testaX = 5;
            var testaY = 1;
            var vettoreX = [];
            var vettoreY = [];
            var dir = 1; //1=dx, 2 = giu, 3 = sx, 4=su
            var velocita = 500; // ogni quanti milliseconti avanza
            var ciclo = 0;
            
            // inizializzo il serpente di partenza
            vettoreX[0]=testaX;
            vettoreY[0]=testaY;
            vettoreX[1]=4;
            vettoreX[2]=3;
            vettoreX[3]=2;
            vettoreX[4]=1;
            vettoreY[1]=1;
            vettoreY[2]=1;
            vettoreY[3]=1;
            vettoreY[4]=1;
           
            
            function HtmlTable(id, cssInline) {
                //constructor
                this.id = id;
                this.cssInline = cssInline;
                this.htmlOutput = "<table cellspacing=\"0\"  id=\"" + this.id + "\" style=\"" + this.cssInline + "\">";
            }
            
            function colore(x,y,color)
            {
                var ide = y+"-"+x;
                attuale=document.getElementById(ide);
                attuale.style.backgroundColor  = color;
            }
            
            function disegnaSerpente()
            {
                for(var i=0; i<vettoreX.length; i++)
                {
                colore(vettoreX[i],vettoreY[i],"Black");
                }
            }
            
           Array.prototype.removePos = function(pos) {
                this.splice(pos,1);
            };
            
            
            function avanza()
            {

                if(dir==1)
                {
                testaX++;
                }                
                if(dir==2)
                {
                testaY++;
                }
                if(dir==3)
                {
                testaX--;
                }
                if(dir==4)
                {
                testaY--;
                } 
                  var ultima = vettoreX.length-1;

                for(var i=ultima; i>0; i-- )
                {
                    vettoreX[i]=vettoreX[i-1];
                    vettoreY[i]=vettoreY[i-1];
                }
                vettoreX[0]=testaX;
                vettoreY[0]=testaY;
               // alert(vettoreX);
                colore(vettoreX[ultima],vettoreY[ultima],"Red");
                vettoreX[ultima]=999;
                vettoreY[ultima]=999;

           
                disegnaSerpente();
            }
            
            function key(e)
            {
                var kc = e.keyCode;
                if(kc == 37)
                {
                    if((dir==2)||(dir==4))
                    {
                        dir=3;
                    }
                }
                if(kc == 38)
                {
                    if((dir==1)||(dir==3))
                    {
                        dir=4;
                    }
                }
                if(kc == 39)
                {
                    if((dir==2)||(dir==4))
                    {
                        dir=1;
                    }
                }
                if(kc == 40)
                {
                    if((dir==1)||(dir==3))
                    {
                        dir=2;
                    }
                }
            }
                        
            //public method for adding a row
            HtmlTable.prototype.AddRow = function(arrCols) {
                contRow++;
                
                this.htmlOutput += "<tr>";              
                for(var i = 0; i < arrCols.length; i++) 
                {
                    var c = i+1;
                    var id=contRow+"-"+c;
                   this.htmlOutput += "<td id=\""+ id+"\" style=\"background-color:red\" height=\"6\">" + arrCols[i] + "</td>";
                }
                this.htmlOutput += "</tr>";                
            }
            
            //public method for getting the resulting html
            HtmlTable.prototype.GetHtml = function() {
                return this.htmlOutput + "</table>";
            }
            
            //*** how to use the class ***
            
            //creates an instance of the class (object)
            var myTable = new HtmlTable("test-table-id", "width: 50%");
            
            //calls the method passing an array as argument
            riga = new Array();
            for(var i=0; i<64; i++)
            {
                riga[i]="";
            }
            for(var i=0;i<64;i++)
            {
            myTable.AddRow(riga);
            }
            
            //injects the resulting html into the div
            document.getElementById('div-table').innerHTML = myTable.GetHtml();

                    // Add keyboard listener. 
            window.addEventListener("keydown", key, false);
            window.addEventListener("keypress", key, false);
            window.addEventListener("keyup", key, false);
        </script>
    </body>
</html>
